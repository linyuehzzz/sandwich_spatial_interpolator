dif3=as.list(dif2[new.attr.name])
dif3=as.list(dif2[0])
dif3=as.list(dif2[1])
devtools::load_all(".")
dif=sandwich.cv(hs.sampling, hs.ssh, hs.reporting, "Population",k=1)
dif=sandwich.cv(hs.sampling, hs.ssh, hs.reporting, "Population",k=5)
devtools::load_all(".")
dev=sandwich.cv(hs.sampling, hs.ssh, hs.reporting, "Population",k=5)
folds[5]
devtools::load_all(".")
dev=sandwich.cv(hs.sampling, hs.ssh, hs.reporting, "Population",k=5)
devtools::load_all(".")
dev=sandwich.cv(hs.sampling, hs.ssh, hs.reporting, "Population",k=5)
There were 25 warnings (use warnings() to see them)
new.attr.name = "Fold5.Population"
dif2=list(dif[new.attr.name])
devtools::load_all(".")
dev=sandwich.cv(hs.sampling, hs.ssh, hs.reporting, "Population",k=5)
devtools::load_all(".")
dif2=list(dev[new.attr.name])
dif2=list(dev$"Fold5.Population")
dif2=list(dev$Fold5.Population)
dif2=list(dev[new.attr.name])
dif^2
dev$Fold5.Population
View(dev)
hs.reporting <- readRDS("C:/Yue/OneDrive - The Ohio State University/research/CAS-IREIS/2019-05 Sandwich a novel software for spatial interpolation of spatially stratified heterogeneous populations/Sandwich/r/sandwich/data/hs.reporting.rds")
hs.sampling <- readRDS("C:/Yue/OneDrive - The Ohio State University/research/CAS-IREIS/2019-05 Sandwich a novel software for spatial interpolation of spatially stratified heterogeneous populations/Sandwich/r/sandwich/data/hs.sampling.rds")
hs.ssh <- readRDS("C:/Yue/OneDrive - The Ohio State University/research/CAS-IREIS/2019-05 Sandwich a novel software for spatial interpolation of spatially stratified heterogeneous populations/Sandwich/r/sandwich/data/hs.ssh.rds")
devtools::load_all(".")
sandwich.cv(hs.sampling, hs.ssh, hs.reporting, "Population", k=5)
out = sandwich.cv(hs.sampling, hs.ssh, hs.reporting, "Population", k=5)
devtools::load_all(".")
out = sandwich.cv(hs.sampling, hs.ssh, hs.reporting, "Population", k=5)
out2=out$Fold5.Population
new.attr.name="Fold5.Population"
out3=dif[[new.attr.name]]
out3=out[[new.attr.name]]
devtools::load_all(".")
out = sandwich.cv(hs.sampling, hs.ssh, hs.reporting, "Population", k=5)
devtools::load_all(".")
mse = sandwich.cv(hs.sampling, hs.ssh, hs.reporting, "Population", k=5)
devtools::load_all(".")
= sandwich.cv(hs.sampling, hs.ssh, hs.reporting, "Population", k=5)
mse = sandwich.cv(hs.sampling, hs.ssh, hs.reporting, "Population", k=5)
devtools::load_all(".")
devtools::load_all(".")
rmse = sandwich.cv(hs.sampling, hs.ssh, hs.reporting, "Population", k=5)
roxygen2::roxygenise()
devtools::build_manual()
roxygen2::roxygenise()
devtools::build_manual()
roxygen2::roxygenise()
devtools::build_manual()
# knitr::opts_chunk$set(
#   collapse = TRUE,
#   comment = "#>"
# )
knitr::opts_chunk$set(echo = TRUE, warning=FALSE, message=FALSE, fig.cap = " ", fig.path='figs/')
hs.cv = sandwich.cv(hs.sampling, hs.ssh, hs.reporting, "Population", k=5)
hs.cv = sandwich.cv(hs.sampling, hs.ssh, hs.reporting, "Population", k=5)
hs.cv
library(sandwich)
roxygen2::roxygenise()
devtools::build_manual()
roxygen2::roxygenise()
devtools::build_manual()
devtools::build_manual()
devtools::build_vignettes()
devtools::build_vignettes()
devtools::build_vignettes()
library("sandwich")
jl.sampling = load.shp("./data", "jl.sampling.shapefile")
?hs
ggplot(data=jl.sampling) + geom_sf(aes(color=Jiashu))
summary(ji.sampling$Jiashu)
ggplot(data=jl.sampling) + geom_sf(aes(color=Jiashu))
> summary(jl.sampling$Jiashu)
summary(jl.sampling$Jiashu)
summary(jl.sampling$Shushu)
library(tidyverse)
write_rds(jl.sampling, path = file.path("./data", "jl.sampling.rds"))
data(jl.sampling)
jl.sampling <- readRDS("C:/Yue/OneDrive - The Ohio State University/research/CAS-IREIS/2019-05 Sandwich a novel software for spatial interpolation of spatially stratified heterogeneous populations/Sandwich/r/sandwich/data/jl.sampling.rds")
jl.sampling <- readRDS("C:/Yue/OneDrive - The Ohio State University/research/CAS-IREIS/2019-05 Sandwich a novel software for spatial interpolation of spatially stratified heterogeneous populations/Sandwich/r/sandwich/data/jl.sampling.rds")
jl.ssh = load.shp("./data", "jl.ssh.shapefile")
library(sandwich)
jl.ssh = load.shp("./data", "jl.ssh.shapefile")
write_rds(jl.ssh, path = file.path("./data", "jl.ssh.rds"))
jl.ssh <- readRDS("C:/Yue/OneDrive - The Ohio State University/research/CAS-IREIS/2019-05 Sandwich a novel software for spatial interpolation of spatially stratified heterogeneous populations/Sandwich/r/sandwich/data/jl.ssh.rds")
jl.reporting = load.shp("./data", "jl.reporting.shapefile")
write_rds(jl.reporting, path = file.path("./data", "jl.reporting.rds"))
jl.ssh = load.shp("./data", "jl.ssh.shapefile")
write_rds(jl.ssh, path = file.path("./data", "jl.ssh.rds"))
jl.ssh2 = load.shp("./data", "jl.ssh2.shapefile")
write_rds(jl.ssh2, path = file.path("./data", "jl.ssh2.rds"))
hs.reporting <- readRDS("C:/Yue/OneDrive - The Ohio State University/research/CAS-IREIS/2019-05 Sandwich a novel software for spatial interpolation of spatially stratified heterogeneous populations/Sandwich/r/sandwich/data/hs.reporting.rds")
hs.sampling <- readRDS("C:/Yue/OneDrive - The Ohio State University/research/CAS-IREIS/2019-05 Sandwich a novel software for spatial interpolation of spatially stratified heterogeneous populations/Sandwich/r/sandwich/data/hs.sampling.rds")
hs.ssh <- readRDS("C:/Yue/OneDrive - The Ohio State University/research/CAS-IREIS/2019-05 Sandwich a novel software for spatial interpolation of spatially stratified heterogeneous populations/Sandwich/r/sandwich/data/hs.ssh.rds")
hs.ssh2 <- readRDS("C:/Yue/OneDrive - The Ohio State University/research/CAS-IREIS/2019-05 Sandwich a novel software for spatial interpolation of spatially stratified heterogeneous populations/Sandwich/r/sandwich/data/hs.ssh2.rds")
jl.reporting <- readRDS("C:/Yue/OneDrive - The Ohio State University/research/CAS-IREIS/2019-05 Sandwich a novel software for spatial interpolation of spatially stratified heterogeneous populations/Sandwich/r/sandwich/data/jl.reporting.rds")
jl.sampling <- readRDS("C:/Yue/OneDrive - The Ohio State University/research/CAS-IREIS/2019-05 Sandwich a novel software for spatial interpolation of spatially stratified heterogeneous populations/Sandwich/r/sandwich/data/jl.sampling.rds")
jl.ssh2 <- readRDS("C:/Yue/OneDrive - The Ohio State University/research/CAS-IREIS/2019-05 Sandwich a novel software for spatial interpolation of spatially stratified heterogeneous populations/Sandwich/r/sandwich/data/jl.ssh2.rds")
jl.ssh <- readRDS("C:/Yue/OneDrive - The Ohio State University/research/CAS-IREIS/2019-05 Sandwich a novel software for spatial interpolation of spatially stratified heterogeneous populations/Sandwich/r/sandwich/data/jl.ssh.rds")
library(sandwich)
remove.packages("rsandwich", lib="~/R/win-library/4.0")
jl.join = geodetector.data(jl.sampling, jl.ssh, "trCode")
jl.join = geodetector.data(jl.join, jl.ssh2, "trCode_2")
geodetector.factor(jl.join, "Shushu", c("trCode", "trCode_2"))
geodetector.interaction(jl.join, "Shushu", c("trCode", "trCode_2"))
jl.sw = sandwich.model(jl.sampling, jl.ssh2, jl.reporting, "Shushu")
devtools::load_all(".")
install.packages("lwgeom")
devtools::load_all(".")
jl.sw = sandwich.model(jl.sampling, jl.ssh2, jl.reporting, "Shushu")
plot.mean(jl.sw)
plot.se(jl.sw)
jl.sw = sandwich.model(jl.sampling, jl.ssh, jl.reporting, "Shushu")
ggplot(data=jl.ssh2) + geom_sf(aes(fill=trCode_2)) + labs(fill='Strata 2')
ggplot(data=jl.ssh) + geom_sf(aes(fill=trCode)) + labs(fill='Strata 1')
ggplot(data=jl.reporting) + geom_sf(aes(fill=OBJECTID)) + labs(fill='r')
View(jl.sw)
devtools::load_all(".")
sandwich.model(jl.sampling, jl.ssh, jl.reporting, "Shushu")
jl.sandwich.model(jl.sampling, jl.ssh, jl.reporting, "Shushu")
jl.sw = sandwich.model(jl.sampling, jl.ssh, jl.reporting, "Shushu")
plot.mean(jl.sw)
devtools::load_all(".")
jl.sw = sandwich.model(jl.sampling, jl.ssh, jl.reporting, "Shushu")
View(jl.sw)
devtools::load_all(".")
jl.sw = sandwich.model(jl.sampling, jl.ssh, jl.reporting, "Shushu")
devtools::load_all(".")
jl.sw = sandwich.model(jl.sampling, jl.ssh, jl.reporting, "Shushu")
devtools::load_all(".")
jl.sw = sandwich.model(jl.sampling, jl.ssh, jl.reporting, "Shushu")
devtools::load_all(".")
jl.sw = sandwich.model(jl.sampling, jl.ssh, jl.reporting, "Shushu")
plot.mean(jl.se)
plot.mean(jl.sw)
plot.se(jl.sw)
plot.mean(jl.sw)
plot.se(jl.sw)
View(jl.sw)
jl.sw2 = sandwich.model(jl.sampling, jl.ssh2, jl.reporting, "Shushu")
plot.mean(jl.sw2)
View(jl.sw)
View(jl.sw2)
plot.mean(jl.sw2)
plot.se(jl.sw2)
devtools::load_all(".")
roxygen2::roxygenise()
devtools::build_manual()
devtools::build_vignettes()
roxygen2::roxygenise()
devtools::build_manual()
roxygen2::roxygenise()
devtools::build_manual()
jl.reporting <- readRDS("C:/Yue/OneDrive - The Ohio State University/research/CAS-IREIS/2019-05 Sandwich a novel software for spatial interpolation of spatially stratified heterogeneous populations/Sandwich/r/sandwich/data/jl.reporting.rds")
jl.sampling <- readRDS("C:/Yue/OneDrive - The Ohio State University/research/CAS-IREIS/2019-05 Sandwich a novel software for spatial interpolation of spatially stratified heterogeneous populations/Sandwich/r/sandwich/data/jl.sampling.rds")
jl.ssh <- readRDS("C:/Yue/OneDrive - The Ohio State University/research/CAS-IREIS/2019-05 Sandwich a novel software for spatial interpolation of spatially stratified heterogeneous populations/Sandwich/r/sandwich/data/jl.ssh.rds")
jl.ssh2 <- readRDS("C:/Yue/OneDrive - The Ohio State University/research/CAS-IREIS/2019-05 Sandwich a novel software for spatial interpolation of spatially stratified heterogeneous populations/Sandwich/r/sandwich/data/jl.ssh2.rds")
citation()
devtools::load_all(".")
sandwich.model(jl.samling, jl.ssh2, jl.reporting, "Shushu")
jl.sw = sandwich.model(jl.sampling, jl.ssh2, jl.reporting, "Shushu")
devtools::load_all(".")
jl.sw = sandwich.model(jl.sampling, jl.ssh2, jl.reporting, "Shushu")
devtools::load_all(".")
jl.sw = sandwich.model(jl.sampling, jl.ssh2, jl.reporting, "Shushu")
devtools::load_all(".")
warnings()
devtools::load_all(".")
jl.sw = sandwich.model(jl.sampling, jl.ssh2, jl.reporting, "Shushu")
plot.mean(hs.sw)
plot.mean(jl.sw)
plot.se(jl.sw)
hs.jl.con = sandwich.confint(jl.sw, level=.95)
plot.ci(hs.jl.con)
jl.cv = sandwich.cv(jl.sampling, jl.ssh, jl.reporting, "Shushu", k=5)
devtools::load_all(".")
jl.cv = sandwich.cv(jl.sampling, jl.ssh, jl.reporting, "Shushu", k=5)
devtools::load_all(".")
jl.cv = sandwich.cv(jl.sampling, jl.ssh, jl.reporting, "Shushu", k=5)
data(hs.sampling)
devtools::load_all(".")
library(sandwuch)
library(sandwich)
data(hs.sampling)
hs.reporting <- readRDS("C:/Yue/OneDrive - The Ohio State University/research/CAS-IREIS/2019-05 Sandwich a novel software for spatial interpolation of spatially stratified heterogeneous populations/Sandwich/r/sandwich/data/hs.reporting.rds")
hs.reporting = readRDS(hs.reporting.rds)
hs.reporting = readRDS("hs.reporting.rds")
library(sandwich)
data(hs.sampling)
hs.ssh <- readRDS("C:/Yue/OneDrive - The Ohio State University/research/CAS-IREIS/2019-05 Sandwich a novel software for spatial interpolation of spatially stratified heterogeneous populations/Sandwich/r/sandwich/data/hs.ssh.rds")
load(hs.ssh)
load(hs.ssh.rds)
library(sandwich)
?hs
devtools::use_data(hs.ssh)
save(hs.ssh, file="data/hs.ssh.RData")
data(hs.ssh)
save(hs.sampling, file="data/hs.sampling.RData")
hs.sampling <- readRDS("C:/Yue/OneDrive - The Ohio State University/research/CAS-IREIS/2019-05 Sandwich a novel software for spatial interpolation of spatially stratified heterogeneous populations/Sandwich/r/sandwich/data/hs.sampling.rds")
hs.ssh2 <- readRDS("C:/Yue/OneDrive - The Ohio State University/research/CAS-IREIS/2019-05 Sandwich a novel software for spatial interpolation of spatially stratified heterogeneous populations/Sandwich/r/sandwich/data/hs.ssh2.rds")
save(hs.sampling, file="data/hs.sampling.RData")
save(hs.ssh2, file="data/hs.ssh2.RData")
save(hs.reporting, file="data/hs.reporting.RData")
data("hs.sampling")
ggplot(data=hs.sampling) + geom_sf(aes(color=Population))
ggplot(data=hs.ssh) + geom_sf(aes(fill=STR_1)) + labs(fill='SSH 1')
ggplot(data=hs.ssh2) + geom_sf(aes(fill=STR_2)) + labs(fill='SSH 2')
ggplot(data=hs.reporting) + geom_sf(aes(fill=CODE))
grid.arrange(p1, p2, p3, p4, nrow=2)
p1=ggplot(data=hs.sampling) + geom_sf(aes(color=Population))+ ggtitle("Sampling Layer")
p2=ggplot(data=hs.ssh) + geom_sf(aes(fill=STR_1)) + labs(fill="Code") + ggtitle("SSH Layer A")
p3=ggplot(data=hs.ssh2) + geom_sf(aes(fill=STR_2)) + labs(fill="Code") + ggtitle("SSH Layer A")
p4=ggplot(data=hs.reporting) + geom_sf(aes(fill=CODE)) + ggtitle("Reporting Layer")
grid.arrange(p1, p2, p3, p4, nrow=2)
p1=ggplot(data=hs.sampling) + geom_sf(aes(color=Population)) + ggtitle("Sampling Layer") + theme(plot.title=element_text(hjust=0.5))
p2=ggplot(data=hs.ssh) + geom_sf(aes(fill=STR_1)) + labs(fill="Code") + ggtitle("SSH Layer A") + theme(plot.title=element_text(hjust=0.5))
p3=ggplot(data=hs.ssh2) + geom_sf(aes(fill=STR_2)) + labs(fill="Code") + ggtitle("SSH Layer A") + theme(plot.title=element_text(hjust=0.5))
p4=ggplot(data=hs.reporting) + geom_sf(aes(fill=CODE)) + ggtitle("Reporting Layer") + theme(plot.title=element_text(hjust=0.5))
grid.arrange(p1, p2, p3, p4, nrow=2)
p3=ggplot(data=hs.ssh2) + geom_sf(aes(fill=STR_2)) + labs(fill="Code") + ggtitle("SSH Layer B") + theme(plot.title=element_text(hjust=0.5))
grid.arrange(p1, p2, p3, p4, nrow=2)
p4=ggplot(data=hs.reporting) + geom_sf(aes(fill=CODE)) + labs(fill="Code") + ggtitle("Reporting Layer") + theme(plot.title=element_text(hjust=0.5))
devtools::build_vignettes()
devtools::build_vignettes()
ggplot(data=hs.sampling) + geom_sf(aes(color=Population)) + ggtitle("Sampling Layer") + theme(plot.title=element_text(hjust=0.5))
ggplot(data=hs.reporting) + geom_sf(aes(fill=CODE)) + labs(fill="Code") + ggtitle("Reporting Layer") + theme(plot.title=element_text(hjust=0.5))
ggplot(data=hs.ssh2) + geom_sf(aes(fill=STR_2)) + labs(fill="Code") + ggtitle("SSH Layer B") + theme(plot.title=element_text(hjust=0.5))
ggplot(data=hs.reporting) + geom_sf(aes(fill=CODE)) + labs(fill="Code") + ggtitle("Reporting Layer") + theme(plot.title=element_text(hjust=0.5))
ggplot(data=hs.ssh) + geom_sf(aes(fill=STR_1)) + labs(fill="Code") + ggtitle("SSH Layer A") + theme(plot.title=element_text(hjust=0.5))
ggplot(data=hs.sampling) + geom_sf(aes(color=Population)) + ggtitle("Sampling Layer") + theme(plot.title=element_text(hjust=0.5))
devtools::build_vignettes()
ggplot(data=hs.sampling) + geom_sf(aes(color=Population)) +
labs(fill="Population\ndensity\(persons per\nsquare mile") +
ggtitle("Sampling Layer") + theme(plot.title=element_text(hjust=0.5))
# knitr::opts_chunk$set(
#   collapse = TRUE,
#   comment = "#>"
# )
knitr::opts_chunk$set(echo = TRUE, warning=FALSE, message=FALSE, fig.cap = " ", fig.path='figs/')
hs.sampling = load.shp("./data", "hs.sampling.shapefile")
hs.ssh = load.shp("./data", "hs.ssh.shapefile")
# here's another candidate SSH layer
hs.ssh2 = load.shp("./data", "hs.ssh2.shapefile")
hs.reporting = load.shp("./data", "hs.reporting.shapefile")
# sampling layer
ggplot(data=hs.sampling) + geom_sf(aes(color=Population)) + labs(fill="Population\ndensity\n(persons per\nsquare mile)") + ggtitle("Sampling Layer") + theme(plot.title=element_text(hjust=0.5))
# SSH layer
ggplot(data=hs.ssh) + geom_sf(aes(fill=STR_1)) + labs(fill="Code") +
ggtitle("SSH Layer A") + theme(plot.title=element_text(hjust=0.5))
# another SSH layer
ggplot(data=hs.ssh2) + geom_sf(aes(fill=STR_2)) + labs(fill="Code") +
ggtitle("SSH Layer B") + theme(plot.title=element_text(hjust=0.5))
# reporting layer
ggplot(data=hs.reporting) + geom_sf(aes(fill=CODE)) + labs(fill="Code") +
ggtitle("Reporting Layer") + theme(plot.title=element_text(hjust=0.5))
ggplot(data=hs.sampling) + geom_sf(aes(color=Population)) +
labs(fill="Population\ndensity\n(persons per\nsquare mile)") +
ggtitle("Sampling Layer") + theme(plot.title=element_text(hjust=0.5))
devtools::build_vignettes()
devtools::build_vignettes()
devtools::build_vignettes()
devtools::build_vignettes()
hs.sw = sandwich.model(hs.sampling, hs.ssh, hs.reporting, "Population")
plot.mean(hs.sw)
plot.se(hs.sw)
library(sandwich)
hs.sw = sandwich.model(hs.sampling, hs.ssh, hs.reporting, "Population")
plot.mean(hs.sw)
devtools::load_all(".")
plot.mean(hs.sw)
plot.se(hs.sw)
hs.sw.con = sandwich.confint(object=hs.sw, level=.95)
plot.ci(hs.sw.con)
roxygen2::roxygenise()
devtools::build_manual()
devtools::build_vignettes()
library("sandwich")
jl.sampling <- readRDS("jl.sampling.rds")
jl.sampling <- readRDS("data/jl.sampling.rds")
save(jl.sampling, file = "data/jl.sampling.RData")
jl.reporting <- readRDS("data/jl.reporting.rds")
save(jl.reporting, file = "data/jl.reporting.RData")
data("jl.reporting")
jl.ssh <- readRDS("data/jl.ssh.rds")
save(jl.ssh, file = "data/jl.ssh.RData")
jl.ssh2 <- readRDS("data/jl.ssh2.rds")
save(jl.ssh2, file = "data/jl.ssh2.RData")
devtools::load_all(".")
data("jl.reporting")
summary(jl.sampling$Shushu)
ggplot(data=jl.sampling) + geom_sf(aes(color=Shushu))
bc.sampling = load.shp("./data", "bc_sampling.shapefile")
bc.sampling = load.shp("./data", "bc_sampling")
save(bc.sampling, file = "data/bc.sampling.RData")
devtools::load_all(".")
data(bc.sampling)
summary(bc.sampling$Incidence_)
ggplot(data=jl.sampling) + geom_sf(aes(color=Shushu))
ggplot(data=bc.sampling) + geom_sf(aes(color=Incidence_))
bc.ssh = load.shp("./data", "bc_ssh")
save(bc.ssh, file = "data/bc.ssh.RData")
ggplot(data=bc.ssh) + geom_sf(aes(color=Urban_Clas))
bc.reporting = load.shp("./data", "bc_reporting")
save(bc.reporting, file = "data/bc.reporting.RData")
ggplot(data=bc.reporting) + geom_sf(aes(color=GID_0))
devtools::load_all(".")
geodetector.factor(bc.sampling, "Incidence_", "Urban_Clas")
bc.sw = sandwich.model(bc.sampling, bc.ssh, bc.reporting, "Incidence_")
plot.mean(bc.sw)
save(bc.sw, file = "data/bc.sw.RData")
plot.se(bc.sw)
View(bc.sw)
View(bc.sw)
devtools::load_all(".")
tmp = sandwich.model(bc.sampling, bc.ssh, bc.reporting, "Incidence_")
tmp$se
tmp$mean
devtools::load_all(".")
tmp = sandwich.model(bc.sampling, bc.ssh, bc.reporting, "Incidence_")
devtools::load_all(".")
tmp = sandwich.model(bc.sampling, bc.ssh, bc.reporting, "Incidence_")
tmp$se
tmp$df
devtools::load_all(".")
bc.sw = sandwich.model(bc.sampling, bc.ssh, bc.reporting, "Incidence_")
plot.mean(bc.sw)
plot.se(bc.sw)
plot.se(bc.sw) + scale_fill_brewer(palette="Dark2")
devtools::load_all(".")
plot.mean(bc.sw)
devtools::load_all(".")
plot.mean(bc.sw)
devtools::load_all(".")
plot.mean(bc.sw)+ scico::scale_fill_scico(palette = "lajolla")
plot.mean(bc.sw)+scale_color_gradient(low = 'greenyellow', high = 'forestgreen')
devtools::load_all(".")
plot.mean(bc.sw)
devtools::load_all(".")
plot.mean(bc.sw)
devtools::load_all(".")
plot.mean(bc.sw)
devtools::load_all(".")
plot.mean(bc.sw)
devtools::load_all(".")
plot.se(bc.sw)
plot.ci(bc.sw)
bc.sw.con = sandwich.confint(bc.sw, level=.95)
plot.ci(bc.sw)
plot.ci(bc.sw.con)
bc.sw.con$ci.low
bc.sw$se
bc.sw$df
devtools::load_all(".")
bc.sw.con = sandwich.confint(bc.sw, level=.95)
bc.sw.con$ci.low
plot.ci(bc.sw.con)
bc.cv = sandwich.cv(bc.sampling, bc.ssh, bc.reporting, "Incidence_", k=5)
plot.se(bc.sw)
plot.mean(bc.sw)
bc.cv = sandwich.cv(bc.sampling, bc.ssh, bc.reporting, "Incidence_", k=5)
bc.cv
ggplot(data=bc.sampling) + geom_sf(aes(color=Incidence_)) +
ggtitle("Sampling Layer") + theme(plot.title=element_text(hjust=0.5))
ggplot(data=bc.sampling) + geom_sf(aes(color=Incidence_)) +
+     ggtitle("Sampling Layer") + theme(plot.title=element_text(hjust=0.5)) + scale_fill_gradient(low = 'white', high = 'red')
ggplot(data=bc.sampling) + geom_sf(aes(color=Incidence_)) + ggtitle("Sampling Layer") + theme(plot.title=element_text(hjust=0.5))+ scale_fill_gradient(low = 'white', high = 'red')
ggplot(data=bc.sampling) + geom_sf(aes(color=Incidence_)) + ggtitle("Sampling Layer") + theme(plot.title=element_text(hjust=0.5))+ scale_color_gradient(low = 'white', high = 'red')
p1 = ggplot(data=bc.sampling) + geom_sf(aes(color=Incidence_)) + ggtitle("Sampling Layer") + theme(plot.title=element_text(hjust=0.5))+ scale_color_gradient(low = 'white', high = 'red')
p1+ ggplot(data=bc.ssh) + geom_sf(aes(color=OBJECTID)) + scale_fill_gradient(low = 'white', high = 'red')
p1 = ggplot(data=bc.sampling) + geom_sf(aes(color=Incidence_)) + scale_color_gradient(low = 'white', high = 'red')
p1+ geom_sf(data=bc.ssh, aes(color=OBJECTID)) + scale_fill_gradient(low = 'white', high = 'red')
p1+ geom_sf(data=bc.ssh, aes(color=OBJECTID)) + scale_fill_gradient(low = 'greenyellow', high = 'forestgreen')
class(bc.ssh)
bc.ssh
plot(bc.ssh)
ggplot(data=bc.ssh) + geom_sf(aes(fill=OBJECTID)) + labs(fill="OBJECTID")
ggplot(data=bc.ssh) + geom_sf(aes(fill=OBJECTID)) + labs(fill="OBJECTID") + scale_fill_gradient(low = 'white', high = 'red')
ggplot(data=bc.sampling) + geom_sf(aes(color=Incidence_)) + scale_color_gradient(low = 'white', high = 'red') + geom_sf(data=bc.reporting)
ggplot(data=bc.sampling) + geom_sf(data=bc.sampling + aes(color=Incidence_)) + scale_color_gradient(low = 'white', high = 'red')
ggplot(data=bc.sampling) + geom_sf(data=bc.sampling, aes(color=Incidence_)) + scale_color_gradient(low = 'white', high = 'red')
ggplot(data=bc.sampling) + geom_sf()+geom_sf(data=bc.sampling, aes(color=Incidence_)) + scale_color_gradient(low = 'white', high = 'red')
ggplot(data=bc.sampling) + geom_sf()
ggplot(data=bc.ssh) + geom_sf() + geom_sf(data=bc.sampling, aes(color=Incidence_)) + scale_color_gradient(low = 'white', high = 'red')
ggplot(data=bc.reporting) + geom_sf(fill = "antiquewhite1") + geom_sf(data=bc.sampling, aes(color=Incidence_)) + scale_color_gradient(low = 'white', high = 'red')
ggplot(data=bc.reporting) + geom_sf(fill = "antiquewhite1") + geom_sf(data=bc.sampling, aes(color=Incidence_)) + scale_color_gradient(low = 'white', high = 'red') + labs(fill="Incidence")
ggplot(data=bc.reporting) + geom_sf(fill = "antiquewhite1") + geom_sf(data=bc.sampling, aes(color=Incidence_)) + labs(color="Incidence") + scale_color_gradient(low = 'white', high = 'red')
ggplot(data=bc.ssh) + geom_sf(aes(fill=OBJECTID)) + labs(fill="Code") +
x
ggplot(data=bc.ssh) + geom_sf(aes(fill=OBJECTID)) + labs(fill="Code") + scale_color_manual(low = 'white', high = 'red')
ggplot(data=bc.ssh) + geom_sf(aes(fill=factor(OBJECTID))) + labs(fill="Code") + scale_color_manual(low = 'white', high = 'red')
ggplot(data=bc.ssh) + geom_sf(aes(fill=factor(OBJECTID))) + labs(fill="Code") + scale_color_manual(values = colors)
ggplot(data=bc.ssh) + geom_sf(aes(fill=factor(OBJECTID))) + labs(fill="Code") + scale_color_manual(values = colors) + guides(fill=guide_legend(nrow=3))
ggplot(data=bc.ssh) + geom_sf(aes(fill=factor(OBJECTID))) + labs(fill="Code") + scale_color_manual(values = colors) + guides(fill=guide_legend(nrow=10))
ggplot(data=bc.ssh) + geom_sf(aes(fill=OBJECTID)) + labs(fill="Code") + guides(fill=guide_legend(nrow=10)) + ylim(15,55)
devtools::load_all(".")
ggplot(data=bc.ssh) + geom_sf(aes(fill=OBJECTID)) + labs(fill="Code") + guides(fill=guide_legend(nrow=10)) + ylim(15,55)
ggplot(data=bc.ssh) + geom_sf(aes(size=1, fill=factor(OBJECTID))) + labs(fill="Code") + guides(fill=guide_legend(nrow=10)) + ylim(15,55)
ggplot(data=bc.ssh) + geom_sf(aes(size=0.1, fill=factor(OBJECTID))) + labs(fill="Code") + guides(fill=guide_legend(nrow=10)) + ylim(15,55)
ggplot(data=bc.ssh) + geom_sf(aes(fill=factor(OBJECTID))) + labs(fill="Code") + guides(fill=guide_legend(nrow=10)) + ylim(15,55)
ggplot(data=bc.ssh) + geom_sf(aes(fill=factor(OBJECTID)), size=0.001) + labs(fill="Code") + guides(fill=guide_legend(nrow=10)) + ylim(17,55)
ggplot(data=bc.ssh) + geom_sf(aes(fill=factor(OBJECTID)), size=0) + labs(fill="Code") + guides(fill=guide_legend(nrow=10)) + ylim(17,55)
ggplot(data=bc.ssh) + geom_sf(aes(fill=factor(OBJECTID), size=0.01)) + labs(fill="Code") + guides(fill=guide_legend(nrow=10)) + ylim(17,55)
ggplot(data=bc.ssh) + geom_sf(aes(fill=factor(OBJECTID))) + labs(fill="Code") + guides(fill=guide_legend(nrow=10)) + ylim(17,55)
roxygen2::roxygenise()
roxygen2::roxygenise()
devtools::build_manual()
roxygen2::roxygenise()
devtools::build_manual()
p1 = ggplot(bc.sampling, aes(x=Incidence_))
p1 + geom_density() +
geom_vline(aes(xintercept = mean(Incidence_)),
linetype = "dashed", size = 0.6)
a + geom_histogram(aes(y = ..density..),
colour="black", fill="white") +
geom_density(alpha = 0.2, fill = "#FF6666")
p1 + geom_histogram(aes(y = ..density..),
+                    colour="black", fill="white") +
+     geom_density(alpha = 0.2, fill = "#FF6666")
p1 + geom_histogram(aes(y = ..density..),
colour="black", fill="white") +
geom_density(alpha = 0.2, fill = "#FF6666")
p1 + geom_histogram(aes(y = ..density..),
+                    colour="black", fill="white") +
+     geom_density(alpha = 0.2, fill = "#FF6666") + xlab("Incidence")
p1 + geom_histogram(aes(y = ..density..),
colour="black", fill="white") +
geom_density(alpha = 0.2, fill = "#FF6666") + xlab("Incidence")
summary(bc.sw)
summary(bc.sw$mean)
summary(bc.sw$se)
summary(bc.sw$CI.LOW)
summary(bc.sw.con$CI.LOW)
summary(bc.sw.con$ci.low)
summary(bc.sw.con$ci.high)
summary(bc.sw.con$ci.upper)
summary(bc.sw.con$ci.up)
summary(bc.sw.con$ci.up-bc.sw.con$ci.low)
plot(variog(bc.sampling, option = "cloud"))
library(geoR)
plot(variog(bc.sampling, option = "cloud"))
install.packages("geoR")
library(geoR)
plot(variog(bc.sampling, option = "cloud"))
plot(bc.sampling)
plot(bc.sampling)
data(meuse)
require(gstat)
library(gstat)
install.packages("gstat")
library(gstat)
data(meuse)
library(sp)
data(meuse)
plot(meuse)
plot(variog(bc.sampling, option = "cloud", max.dist = 309.75))
library(rgdal)
library(tmap)
# Load precipitation data
z <- gzcon(url("http://colby.edu/~mgimond/Spatial/Data/precip.rds"))
P <- readRDS(z)
# Load Texas boudary map
z <- gzcon(url("http://colby.edu/~mgimond/Spatial/Data/texas.rds"))
W <- readRDS(z)
# Replace point boundary extent with that of Texas
P@bbox <- W@bbox
tm_shape(W) + tm_polygons() +
tm_shape(P) +
tm_dots(col="Precip_in", palette = "RdBu", auto.palette.mapping = FALSE,
title="Sampled precipitation \n(in inches)", size=0.7) +
tm_text("Precip_in", just="left", xmod=.5, size = 0.7) +
tm_legend(legend.outside=TRUE)
library(spatstat)  # Used for the dirichlet tessellation function
library(maptools)  # Used for conversion from SPDF to ppp
library(raster)    # Used to clip out thiessen polygons
# Create a tessellated surface
th  <-  as(dirichlet(as.ppp(P)), "SpatialPolygons")
# The dirichlet function does not carry over projection information
# requiring that this information be added manually
proj4string(th) <- proj4string(P)
# The tessellated surface does not store attribute information
# from the point data layer. We'll use the over() function (from the sp
# package) to join the point attributes to the tesselated surface via
# a spatial join. The over() function creates a dataframe that will need to
# be added to the `th` object thus creating a SpatialPolygonsDataFrame object
th.z     <- over(th, P, fn=mean)
th.spdf  <-  SpatialPolygonsDataFrame(th, th.z)
# Finally, we'll clip the tessellated  surface to the Texas boundaries
th.clp   <- raster::intersect(W,th.spdf)
# Map the data
tm_shape(th.clp) +
tm_polygons(col="Precip_in", palette="RdBu", auto.palette.mapping=FALSE,
title="Predicted precipitation \n(in inches)") +
tm_legend(legend.outside=TRUE)
library(sp)
data(meuse)
coordinates(meuse) <- ~x+y
m <- vgm(.59, "Sph", 874, .04)
library(gstat)
m <- vgm(.59, "Sph", 874, .04)
cv.o=krige.cv(ltpb ~ 1, meuse.pb, model=m.ltpb.f, nfold=nrow(meuse.pb),
verbose=FALSE)
plot(v.ltpb.c <- variogram(ltpb ~ 1, data=meuse, cutoff=1800, cloud=T))
meuse.pb <- cbind(meuse.pb,
ltpb = log10(meuse.pb$lead),
ltom = log10(meuse.pb$om),
ltzn = log10(meuse.pb$zinc))
str(meuse.pb)
