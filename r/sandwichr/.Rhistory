install.packages("dplyr")
install.packages("dplyr")
library(scatterpie)
library(totalcensus)
library(dplyr)
set_path_to_census("data/my_census_data")
library(scatterpie)
library(totalcensus)
library(dplyr)
set_path_to_census("data/my_census_data")
library(scatterpie)
library(totalcensus)
library(dplyr)
set_path_to_census("data/my_census_data")
metro <- read_acs1year(
year = 2019,
states = "US",
table_contents = c(
"white = C02003_003",
"black = C02003_004",
"asian = C02003_006"
),
geo_headers = "CBSA",
summary_level = "310"
) %>%
mutate(others = population - white - black - asian)
save(metro, file = "metro.acs.RData")
load("metro.acs.RData")
load("metro.acs.RData")
largest <- metro %>%
filter(population > 1e6) %>%
# Los Angeles metro changed CBSA from 31100 to 31080, hand correct the coordinate
# mutate(lon = ifelse(GEOID == "31000US31080", -118.18194, lon),
#        lat = ifelse(GEOID == "31000US31080", 34.10939, lat)) %>%
select(NAME, lon, lat, total = population, white, black, asian, others) %>%
arrange(-total)
head(largest, 3)
us <- map_data('state')
ggplot(us, aes(long, lat)) +
geom_map(map=us, aes(map_id=region), fill="grey97", color="grey") +
geom_scatterpie(data = largest,
aes(lon, lat, r = sqrt(total)/2000),
cols = c("white", "black", "asian", "others"),
alpha = 0.5) +
scale_fill_manual(
breaks = c("white", "black", "asian", "others"),
labels = c("white alone", "black alone", "asian alone", "others"),
values = c("asian" = "orange",
"white" = "white",
"black" = "black",
"others" = "cyan")
) +
labs(title = "Races in metro areas over one million population",
subtitle = "others includes mixed races and American indians, Alaska natives, native Hawaiians and pacific islanders",
caption = "Source: 2016 ACS 1-year estimate",
fill = NULL) +
coord_fixed() +
theme_bw() +
theme(legend.position = c(0.96, 0.02),
legend.justification = c(1, 0),
panel.grid = element_blank(),
panel.border = element_blank(),
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank())
us <- map_data('state')
ggplot(us, aes(long, lat)) +
geom_map(map=us, aes(map_id=region), fill="grey97", color="grey") +
geom_scatterpie(data = largest,
aes(lon, lat, r = sqrt(total)/2000),
cols = c("white", "black", "asian", "others"),
alpha = 0.5) +
scale_fill_manual(
breaks = c("white", "black", "asian", "others"),
labels = c("white", "black", "Asian", "Others"),
values = c("asian" = "orange",
"white" = "white",
"black" = "black",
"others" = "cyan")
) +
labs(title = "Races in Metro Areas With a Population of Over a Million",
subtitle = "others includes mixed races and American indians, Alaska natives, native Hawaiians and pacific islanders",
caption = "Source: 2019 American Community Survey Single-Year Estimates",
fill = NULL) +
coord_fixed() +
theme_bw() +
theme(legend.position = c(0.96, 0.02),
legend.justification = c(1, 0),
panel.grid = element_blank(),
panel.border = element_blank(),
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank())
us <- map_data('state')
ggplot(us, aes(long, lat)) +
geom_map(map=us, aes(map_id=region), fill="grey97", color="grey") +
geom_scatterpie(data = largest,
aes(lon, lat, r = sqrt(total)/2000),
cols = c("white", "black", "asian", "others"),
alpha = 0.5) +
scale_fill_manual(
breaks = c("white", "black", "asian", "others"),
labels = c("White", "Black or African American", "Asian", "Others"),
values = c("asian" = "orange",
"white" = "white",
"black" = "black",
"others" = "cyan")
) +
labs(title = "Races in Metro Areas With a Population of Over a Million",
subtitle = "Others includes American Indian and Alaska Native, Native Hawaiian and Other Pacific Islander, as well as mixed races.",
caption = "Source: 2019 American Community Survey Single-Year Estimates",
fill = NULL) +
coord_fixed() +
theme_bw() +
theme(legend.position = c(0.96, 0.02),
legend.justification = c(1, 0),
panel.grid = element_blank(),
panel.border = element_blank(),
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank())
us <- map_data('state')
ggplot(us, aes(long, lat)) +
geom_map(map=us, aes(map_id=region), fill="grey97", color="grey") +
geom_scatterpie(data = largest,
aes(lon, lat, r = sqrt(total)/2000),
cols = c("white", "black", "asian", "others"),
alpha = 0.5) +
scale_fill_manual(
breaks = c("white", "black", "asian", "others"),
labels = c("White", "Black or African American", "Asian", "Others"),
values = c("asian" = "orange",
"white" = "white",
"black" = "black",
"others" = "cyan")
) +
labs(title = "Races in Metro Areas With a Population of Over a Million",
subtitle = "Others includes American Indian and Alaska Native, Native Hawaiian and Other Pacific Islander, and mixed races.",
caption = "Source: 2019 American Community Survey Single-Year Estimates",
fill = NULL) +
coord_fixed() +
theme_bw() +
theme(legend.position = c(0.96, 0.02),
legend.justification = c(1, 0),
panel.grid = element_blank(),
panel.border = element_blank(),
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank())
us <- map_data('state')
ggplot(us, aes(long, lat)) +
geom_map(map=us, aes(map_id=region), fill="grey97", color="grey") +
geom_scatterpie(data = largest,
aes(lon, lat, r = sqrt(total)/2000),
cols = c("white", "black", "asian", "others"),
alpha = 0.5) +
scale_fill_manual(
breaks = c("white", "black", "asian", "others"),
labels = c("White", "Black or African American", "Asian", "Others"),
values = c("asian" = "orange",
"white" = "white",
"black" = "black",
"others" = "cyan")
) +
labs(title = "Races in Metro Areas With a Population of Over a Million",
subtitle = "Others includes American Indian and Alaska Native, Native Hawaiian and Other Pacific Islander,\nand mixed races.",
caption = "Source: 2019 American Community Survey Single-Year Estimates",
fill = NULL) +
coord_fixed() +
theme_bw() +
theme(legend.position = c(0.96, 0.02),
legend.justification = c(1, 0),
panel.grid = element_blank(),
panel.border = element_blank(),
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank())
us <- map_data('state')
ggplot(us, aes(long, lat)) +
geom_map(map=us, aes(map_id=region), fill="grey97", color="grey") +
geom_scatterpie(data = largest,
aes(lon, lat, r = sqrt(total)/2000),
cols = c("white", "black", "asian", "others"),
alpha = 0.5) +
scale_fill_manual(
breaks = c("white", "black", "asian", "others"),
labels = c("White", "Black or African American", "Asian", "Others"),
values = c("asian" = "orange",
"white" = "white",
"black" = "black",
"others" = "cyan")
) +
labs(title = "Races in Metro Areas With a Population of Over a Million",
subtitle = "Others includes American Indian and Alaska Native, Native Hawaiian and Other Pacific Islander,\nand mixed races.",
caption = "Source: 2019 American Community Survey Single-Year Estimates",
fill = NULL) +
coord_fixed() +
theme_bw() +
theme(legend.position = c(0.96, 0.02),
legend.justification = c(1, 0),
panel.grid = element_blank(),
panel.border = element_blank(),
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank())
us <- map_data('state')
ggplot(us, aes(long, lat)) +
geom_map(map=us, aes(map_id=region), fill="grey97", color="grey") +
geom_scatterpie(data = largest,
aes(lon, lat, r = sqrt(total)/2000),
cols = c("white", "black", "asian", "others"),
alpha = 0.5) +
scale_fill_manual(
breaks = c("white", "black", "asian", "others"),
labels = c("White", "Black or African American", "Asian", "Others"),
values = c("asian" = "orange",
"white" = "white",
"black" = "black",
"others" = "cyan")
) +
labs(title = "Races in Metro Areas With a Population of Over a Million",
subtitle = "Others includes American Indian and Alaska Native, Native Hawaiian and Other Pacific Islander,\nand mixed races.",
caption = "Source: 2019 American Community Survey Single-Year Estimates",
fill = NULL) +
coord_fixed() +
theme_bw() +
theme(legend.position = c(1, 0.02),
legend.justification = c(1, 0),
panel.grid = element_blank(),
panel.border = element_blank(),
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank())
us <- map_data('state')
ggplot(us, aes(long, lat)) +
geom_map(map=us, aes(map_id=region), fill="grey97", color="grey") +
geom_scatterpie(data = largest,
aes(lon, lat, r = sqrt(total)/2000),
cols = c("white", "black", "asian", "others"),
alpha = 0.5) +
scale_fill_manual(
breaks = c("white", "black", "asian", "others"),
labels = c("White", "Black or African American", "Asian", "Others"),
values = c("asian" = "orange",
"white" = "white",
"black" = "black",
"others" = "cyan")
) +
labs(title = "Races in Metro Areas With a Population of Over a Million",
subtitle = "Others includes American Indian and Alaska Native, Native Hawaiian and Other Pacific Islander,\nand mixed races.",
caption = "Source: 2019 American Community Survey Single-Year Estimates",
fill = NULL) +
coord_fixed() +
theme_bw() +
theme(legend.position = c(1.5, 0.02),
legend.justification = c(1, 0),
panel.grid = element_blank(),
panel.border = element_blank(),
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank())
us <- map_data('state')
ggplot(us, aes(long, lat)) +
geom_map(map=us, aes(map_id=region), fill="grey97", color="grey") +
geom_scatterpie(data = largest,
aes(lon, lat, r = sqrt(total)/2000),
cols = c("white", "black", "asian", "others"),
alpha = 0.5) +
scale_fill_manual(
breaks = c("white", "black", "asian", "others"),
labels = c("White", "Black or African American", "Asian", "Others"),
values = c("asian" = "orange",
"white" = "white",
"black" = "black",
"others" = "cyan")
) +
labs(title = "Races in Metro Areas With a Population of Over a Million",
subtitle = "Others includes American Indian and Alaska Native, Native Hawaiian and Other Pacific Islander,\nand mixed races.",
caption = "Source: 2019 American Community Survey Single-Year Estimates",
fill = NULL) +
coord_fixed() +
theme_bw() +
theme(legend.position = c(1.1, 0.02),
legend.justification = c(1, 0),
panel.grid = element_blank(),
panel.border = element_blank(),
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank())
us <- map_data('state')
ggplot(us, aes(long, lat)) +
geom_map(map=us, aes(map_id=region), fill="grey97", color="grey") +
geom_scatterpie(data = largest,
aes(lon, lat, r = sqrt(total)/2000),
cols = c("white", "black", "asian", "others"),
alpha = 0.5) +
scale_fill_manual(
breaks = c("white", "black", "asian", "others"),
labels = c("White", "Black or African American", "Asian", "Others"),
values = c("asian" = "orange",
"white" = "white",
"black" = "black",
"others" = "cyan")
) +
labs(title = "Races in Metro Areas With a Population of Over a Million",
subtitle = "Others includes American Indian and Alaska Native, Native Hawaiian and Other Pacific Islander,\nand mixed races.",
caption = "Source: 2019 American Community Survey Single-Year Estimates",
fill = NULL) +
coord_fixed() +
theme_bw() +
theme(legend.position = c(1.05, 0.02),
legend.justification = c(1, 0),
panel.grid = element_blank(),
panel.border = element_blank(),
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank())
us <- map_data('state')
ggplot(us, aes(long, lat)) +
geom_map(map=us, aes(map_id=region), fill="grey97", color="grey") +
geom_scatterpie(data = largest,
aes(lon, lat, r = sqrt(total)/2000),
cols = c("white", "black", "asian", "others"),
alpha = 0.5) +
scale_fill_manual(
breaks = c("white", "black", "asian", "others"),
labels = c("White", "Black or African American", "Asian", "Others"),
values = c("asian" = "orange",
"white" = "white",
"black" = "black",
"others" = "cyan")
) +
labs(title = "Races in Metro Areas With a Population of Over a Million",
subtitle = "Others includes American Indian and Alaska Native, Native Hawaiian and Other Pacific Islander,\nand mixed races.",
caption = "Source: 2019 American Community Survey Single-Year Estimates",
fill = NULL) +
coord_fixed() +
theme_bw() +
theme(legend.position = c(1.04, 0.02),
legend.justification = c(1, 0),
panel.grid = element_blank(),
panel.border = element_blank(),
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank())
us <- map_data('state')
ggplot(us, aes(long, lat)) +
geom_map(map=us, aes(map_id=region), fill="grey97", color="grey") +
geom_scatterpie(data = largest,
aes(lon, lat, r = sqrt(total)/2000),
cols = c("white", "black", "asian", "others"),
alpha = 0.5) +
scale_fill_manual(
breaks = c("white", "black", "asian", "others"),
labels = c("White", "Black or African American", "Asian", "Others"),
values = c("asian" = "orange",
"white" = "white",
"black" = "black",
"others" = "cyan")
) +
labs(title = "Races in Metro Areas With a Population of Over a Million",
subtitle = "Others includes American Indian and Alaska Native, Native Hawaiian and Other Pacific Islander,\nand mixed races.",
caption = "Source: 2019 American Community Survey Single-Year Estimates",
fill = NULL) +
coord_fixed() +
theme_bw() +
theme(legend.position = c(1.03, 0.02),
legend.justification = c(1, 0),
panel.grid = element_blank(),
panel.border = element_blank(),
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank())
us <- map_data('state')
ggplot(us, aes(long, lat)) +
geom_map(map=us, aes(map_id=region), fill="grey97", color="grey") +
geom_scatterpie(data = largest,
aes(lon, lat, r = sqrt(total)/2000),
cols = c("white", "black", "asian", "others"),
alpha = 0.5) +
scale_fill_manual(
breaks = c("white", "black", "asian", "others"),
labels = c("White", "Black or African American", "Asian", "Others"),
values = c("asian" = "orange",
"white" = "white",
"black" = "black",
"others" = "cyan")
) +
labs(title = "Races in Metro Areas With a Population of Over a Million",
subtitle = "Others includes American Indian and Alaska Native, Native Hawaiian and Other Pacific Islander,\nand mixed races.",
caption = "Source: 2019 American Community Survey Single-Year Estimates",
fill = NULL) +
coord_fixed() +
theme_bw() +
theme(legend.position = c(1.04, 0.02),
legend.justification = c(1, 0),
panel.grid = element_blank(),
panel.border = element_blank(),
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank())
us <- map_data('state')
ggplot(us, aes(long, lat)) +
geom_map(map=us, aes(map_id=region), fill="grey97", color="grey") +
geom_scatterpie(data = largest,
aes(lon, lat, r = sqrt(total)/2000),
cols = c("white", "black", "asian", "others"),
alpha = 0.5) +
scale_fill_manual(
breaks = c("white", "black", "asian", "others"),
labels = c("White", "Black or African American", "Asian", "Others"),
values = c("asian" = "orange",
"white" = "white",
"black" = "black",
"others" = "cyan")
) +
labs(title = "Races in Metro Areas With a Population of Over a Million",
subtitle = "Others includes American Indian and Alaska Native, Native Hawaiian and Other Pacific Islander,\nand mixed races.",
caption = "Source: 2019 American Community Survey Single-Year Estimates",
fill = NULL) +
coord_fixed() +
theme_bw() +
theme(legend.position = c(1.04, 0.02),
panel.grid = element_blank(),
panel.border = element_blank(),
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank())
us <- map_data('state')
ggplot(us, aes(long, lat)) +
geom_map(map=us, aes(map_id=region), fill="grey97", color="grey") +
geom_scatterpie(data = largest,
aes(lon, lat, r = sqrt(total)/2000),
cols = c("white", "black", "asian", "others"),
alpha = 0.5) +
scale_fill_manual(
breaks = c("white", "black", "asian", "others"),
labels = c("White", "Black or African American", "Asian", "Others"),
values = c("asian" = "orange",
"white" = "white",
"black" = "black",
"others" = "cyan")
) +
labs(title = "Races in Metro Areas With a Population of Over a Million",
subtitle = "Others includes American Indian and Alaska Native, Native Hawaiian and Other Pacific Islander,\nand mixed races.",
caption = "Source: 2019 American Community Survey Single-Year Estimates",
fill = NULL) +
coord_fixed() +
theme_bw() +
theme(legend.position = c(1.04, 0.02),
legend.justification = c(1, 0),
panel.grid = element_blank(),
panel.border = element_blank(),
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank())
us <- map_data('state')
ggplot(us, aes(long, lat)) +
geom_map(map=us, aes(map_id=region), fill="grey97", color="grey") +
geom_scatterpie(data = largest,
aes(lon, lat, r = sqrt(total)/2000),
cols = c("white", "black", "asian", "others"),
alpha = 0.5) +
scale_fill_manual(
breaks = c("white", "black", "asian", "others"),
labels = c("White", "Black or African\nAmerican", "Asian", "Others"),
values = c("asian" = "orange",
"white" = "white",
"black" = "black",
"others" = "cyan")
) +
labs(title = "Races in Metro Areas With a Population of Over a Million",
subtitle = "Others includes American Indian and Alaska Native, Native Hawaiian and Other Pacific Islander,\nand mixed races.",
caption = "Source: 2019 American Community Survey Single-Year Estimates",
fill = NULL) +
coord_fixed() +
theme_bw() +
theme(legend.position = c(1.04, 0.02),
legend.justification = c(1, 0),
panel.grid = element_blank(),
panel.border = element_blank(),
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank())
us <- map_data('state')
ggplot(us, aes(long, lat)) +
geom_map(map=us, aes(map_id=region), fill="grey97", color="grey") +
geom_scatterpie(data = largest,
aes(lon, lat, r = sqrt(total)/2000),
cols = c("white", "black", "asian", "others"),
alpha = 0.5) +
scale_fill_manual(
breaks = c("white", "black", "asian", "others"),
labels = c("White", "Black or African\nAmerican", "Asian", "Others"),
values = c("asian" = "orange",
"white" = "white",
"black" = "black",
"others" = "cyan")
) +
labs(title = "Races in Metro Areas With a Population of Over a Million",
subtitle = "Others includes American Indian and Alaska Native, Native Hawaiian and Other Pacific Islander,\nand mixed races.",
caption = "Source: 2019 American Community Survey Single-Year Estimates",
fill = NULL) +
coord_fixed() +
theme_bw() +
theme(legend.position = c(1, 0.02),
legend.justification = c(1, 0),
panel.grid = element_blank(),
panel.border = element_blank(),
axis.title = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank())
